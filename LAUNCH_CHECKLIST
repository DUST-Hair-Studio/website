ğŸš€ DUST Hair Studio - Production Launch Checklist

================================================================================
CURRENT STATUS: Soft Launch on dusthair.vercel.app
================================================================================

âœ… COMPLETED (Soft Launch)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- [x] Vercel environment variables set for production
- [x] Square credentials configured in Admin Settings (Production mode)
- [x] Square webhook configured for production: https://dusthair.vercel.app/api/webhooks/square
- [x] Square POS API callback URL: https://dusthair.vercel.app/api/webhooks/square
- [x] Square OAuth redirect URL: https://dusthair.vercel.app/booking/confirmation
- [x] NEXT_PUBLIC_APP_URL = https://dusthair.vercel.app

================================================================================
ğŸ¯ PRODUCTION LAUNCH (dusthairstudio.com)
================================================================================

STEP 0: GoDaddy Nameservers (do this first) ................................. âœ… DONE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Before adding any DNS records, set nameservers so DNS is managed in GoDaddy:
â€¢ Go to GoDaddy â†’ your domain (dusthairstudio.com) â†’ DNS or Nameservers
â€¢ Choose "I'll use GoDaddy nameservers" (default)
â€¢ Save. Now the DNS zone is in GoDaddy and the records below will apply.

STEP 1: Add DNS Records in GoDaddy ........................................... âœ… DONE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Go to GoDaddy â†’ My Products â†’ dusthairstudio.com â†’ DNS â†’ Manage DNS.
TTL: Use 1/2 hour (30 min, or 1800 if GoDaddy asks for seconds) for all records during launch so changes propagate quickly; you can increase to 1â€“4 hours later once stable.

Add these records (edit or delete any conflicting ones for @ and www).
If you get "Record name www conflicts with another record": delete the existing www record (A or CNAME) first, then add the CNAME for www.

  Type    Name/Host              Value / Data
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  A       @                     76.76.21.21
  CNAME   www                    cname.vercel-dns.com

  MX      @                      smtp.google.com                    (Priority: 1)
  TXT     @                      google-site-verification=Gp5MoRPL6N9XJHTC6tJ0-ziNiwIl76zOl69ofaGVS08
  TXT     @                      v=spf1 include:_spf.google.com include:amazonses.com ~all

  MX      send.updates           feedback-smtp.us-east-1.amazonses.com   (Priority: 10)
  TXT     send.updates           v=spf1 include:amazonses.com ~all
  TXT     resend._domainkey.updates   p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCsV0FvrpL14u7phreXSdmn3+FV2nCj2m4g9rcWkGh76lg07GelOL8fHjxgEvr1j90Al/p2ZfIySMvYnQde+f1+/Ex8NZWoRdSj7IvkOL824V3u6wEk278aZmg/VVUdoHI9SK0qIY4kZvedT2xJaGPkDIXMTbQFILdd5xAnOaQBRwIDAQAB

  TXT     _dmarc                  v=DMARC1; p=none;

Note: If Resend dashboard shows a different DKIM host, use that exact host.

STEP 2: Configure Custom Domain in Vercel ..................................... âœ… DONE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Go to: Vercel Dashboard â†’ Your project â†’ Settings â†’ Domains
2. Add domain: www.dusthairstudio.com
3. Add domain: dusthairstudio.com (set to redirect to www)
4. Wait for SSL (Vercel will verify DNS; usually instant, up to ~1 hour)

--------------------------------------------------------------------------------
ğŸ”§ TROUBLESHOOTING: Apex (dusthairstudio.com) shows GoDaddy parking / dot-photos
--------------------------------------------------------------------------------
If visiting dusthairstudio.com (no www) shows "parked for free at GoDaddy" or
redirects to dot-photos.com, the apex domain is NOT reaching Vercel. Fix in GoDaddy:

1. Turn OFF parking / monetization
   â€¢ GoDaddy â†’ My Products â†’ dusthairstudio.com
   â€¢ Look for "Parking", "Monetize", "CashParking", or "Forwarding" that might
     point to a parking page. Disable or remove it so DNS records control the domain.

2. Confirm the A record for @ (apex)
   â€¢ Go to DNS â†’ Manage DNS
   â€¢ Ensure there is exactly one A record:  Name = @ (or blank),  Value = 76.76.21.21
   â€¢ If you see a different A record for @ (e.g. GoDaddy parking IP), delete it
     and add/keep the one above. No "Forwarding" for the root should override this.

3. Optional: Use GoDaddy "Forwarding" instead of Vercel redirect
   â€¢ If you prefer: Domain â†’ Forwarding â†’ Add forwarding:
     From: dusthairstudio.com  â†’  To: https://www.dusthairstudio.com (301, permanent)
   â€¢ Then the apex is handled by GoDaddy and always redirects to www. Your A record
     for @ can stay 76.76.21.21 so Vercel still owns it when forwarding is off.

4. Vercel being slow/down
   â€¢ If the apex DNS is correct, a Vercel outage would show a Vercel error or
     timeout, not GoDaddy parking. Seeing GoDaddy/dot-photos means the request
     is still hitting GoDaddy (parking or wrong A record). Check status.vercel.com
     if www also fails to load.

STEP 3: Update Vercel Environment Variable ................................... â¬œ DO NEXT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Change NEXT_PUBLIC_APP_URL:
  FROM: https://dusthair.vercel.app
  TO:   https://www.dusthairstudio.com

STEP 4: Update Square Developer Dashboard (Production Tab) .................... â¬œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Go to: https://developer.squareup.com/apps â†’ Select your app â†’ Production tab

A) Webhook URL:
   FROM: https://dusthair.vercel.app/api/webhooks/square
   TO:   https://www.dusthairstudio.com/api/webhooks/square

B) Point of Sale API â†’ Web Callback URL:
   FROM: https://dusthair.vercel.app/api/webhooks/square
   TO:   https://www.dusthairstudio.com/api/webhooks/square

C) OAuth â†’ Redirect URL:
   FROM: https://dusthair.vercel.app/booking/confirmation
   TO:   https://www.dusthairstudio.com/booking/confirmation

STEP 5: Redeploy on Vercel ..................................................... â¬œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Go to Vercel Dashboard â†’ Deployments
2. Click "Redeploy" on latest deployment
3. Wait for deployment to complete

STEP 6: Test Everything on New Domain ......................................... â¬œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- [ ] Visit https://www.dusthairstudio.com - site loads
- [ ] Test customer booking flow
- [ ] Test "Pay Now (POS)" - payment completes and status updates
- [ ] Test "Send Payment Link" - link is created and email is received (see Payment Links below)
- [ ] Test email links point to correct domain
- [ ] Test admin portal: https://www.dusthairstudio.com/admin

================================================================================
ğŸ“‹ REFERENCE: Environment Variables (Already Set in Vercel)
================================================================================

Supabase:
  - NEXT_PUBLIC_SUPABASE_URL
  - NEXT_PUBLIC_SUPABASE_ANON_KEY
  - SUPABASE_SERVICE_ROLE_KEY

Square (fallback - primary config is in Admin Settings):
  - SQUARE_ACCESS_TOKEN (production token)
  - SQUARE_ENVIRONMENT=production
  - SQUARE_LOCATION_ID
  - SQUARE_WEBHOOK_SIGNATURE_KEY (optional, for signature verification)

Email:
  - RESEND_API_KEY

Google Calendar:
  - GOOGLE_CLIENT_ID
  - GOOGLE_CLIENT_SECRET

App URL (âš ï¸ UPDATE FOR PRODUCTION LAUNCH):
  - NEXT_PUBLIC_APP_URL=https://dusthair.vercel.app
    â†’ Change to: https://www.dusthairstudio.com

================================================================================
âš ï¸  GOOGLE CALENDAR - PRODUCTION
================================================================================

1) Add production redirect URI in Google Cloud Console (one-time per environment):
   - Go to: https://console.cloud.google.com â†’ Your project
   - APIs & Services â†’ Credentials â†’ Your OAuth 2.0 Client ID
   - Under "Authorized redirect URIs" add:
     â€¢ https://dusthair.vercel.app/admin/schedule   (soft launch)
     â€¢ https://www.dusthairstudio.com/admin/schedule   (when you switch to custom domain)
   - Save. You can have multiple URIs (localhost + all production URLs).

2) App URL is already correct:
   - NEXT_PUBLIC_APP_URL in Vercel is used for the redirect; no code changes needed.
   - When you change to custom domain, update NEXT_PUBLIC_APP_URL and add the new
     redirect URI in Google (step 1).

3) If Google Cloud app is in "Testing" mode, refresh tokens expire after 7 days.
   To fix (one-time):
   - Go to: https://console.cloud.google.com
   - APIs & Services â†’ OAuth consent screen
   - Click "PUBLISH APP"
   (Keeps "unverified app" warning during admin setup but tokens won't expire.)

================================================================================
ğŸ“§ EMAIL (already in Step 1)
================================================================================

Step 1 includes SPF, Resend MX/DKIM/SPF for send.updates, and DMARC. After DNS
propagates, verify the domain in Resend dashboard if you use send.updates subdomain.

WORKAROUND if domain not verified yet (new Resend account):
Add to .env.local and Vercel env vars:
  RESEND_FROM_OVERRIDE=DUST Hair Studio <onboarding@resend.dev>
This uses Resend's default sender so emails work before domain verification.
Remove once domain is verified; then emails will send from business_email.

STEP X: Supabase Auth URL Configuration (REQUIRED for admin invites) ........... â¬œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
If invite links send users to login instead of "Set Your Password", fix this first.

Supabase Dashboard â†’ Authentication â†’ URL Configuration

1. Site URL
   â€¢ Local:   http://localhost:3000
   â€¢ Prod:    https://www.dusthairstudio.com
   â€¢ NOT /admin/login â€” Site URL must be your app root.

2. Redirect URLs â€” add these exact URLs (wildcards can fail for invites):
   â€¢ http://localhost:3000/admin/accept-invite
   â€¢ https://www.dusthairstudio.com/admin/accept-invite
   (Wildcards like http://localhost:3000/** are fine for other flows; add the explicit
    accept-invite URL to be safe.)

When redirect_to isnâ€™t in the list, Supabase falls back to Site URL and the invite
flow breaks (user ends up on login without tokens).

STEP X+1: Configure Supabase Auth SMTP (Resend) ............................... â¬œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Required for admin invite emails, password reset, and other Auth emails to send.

1. Resend Dashboard â†’ API Keys â†’ Create API key (or use existing)
2. Supabase Dashboard â†’ Project Settings â†’ Auth â†’ SMTP Settings
3. Enable Custom SMTP:
   â€¢ Sender email: verified domain in Resend (e.g. noreply@dusthairstudio.com)
   â€¢ Sender name: DUST Hair Studio
   â€¢ Host: smtp.resend.com
   â€¢ Port: 465 (SSL) or 587 (TLS)
   â€¢ Username: resend
   â€¢ Password: your Resend API key
4. Save. Test by sending an admin invite from Settings â†’ Admins.

================================================================================
ğŸ’³ PAYMENT LINKS (Send Payment Link email)
================================================================================

If "Send Payment Link" fails or emails don't arrive after going live:

1) Runtime: The send-payment-link API route must run on Node.js (not Edge).
   - Code has: export const runtime = 'nodejs' in app/api/bookings/send-payment-link/route.ts
   - Redeploy after any change so Vercel picks it up.

2) Square (production): In Admin â†’ Settings â†’ Payments, ensure:
   - Square Payment Processing is ON
   - Square Environment = Production (Live)
   - Square Access Token = production token (from Square Developer â†’ Production)
   - Square Location ID = your live location ID

3) App URL: NEXT_PUBLIC_APP_URL in Vercel must match your live domain
   (e.g. https://www.dusthairstudio.com). Payment link redirect URL is built from this.

4) Resend (email delivery): Payment link emails use Resend. Ensure:
   - RESEND_API_KEY is set in Vercel
   - If using custom "from" (e.g. business email): domain must be verified in Resend
   - Workaround until domain verified: set RESEND_FROM_OVERRIDE=DUST Hair Studio <onboarding@resend.dev>
     in Vercel env (see EMAIL section above). Remove after domain is verified.

5) Check Vercel Function Logs: Deployments â†’ select deployment â†’ Logs. Filter for
   "SEND PAYMENT LINK" or "PAYMENT LINK EMAIL" to see Square or Resend errors.

================================================================================
ğŸ§ª QUICK TEST CHECKLIST
================================================================================

Before going live, verify:
- [ ] Booking flow works end-to-end
- [ ] Payment via POS updates booking to "paid"
- [ ] "Send Payment Link" creates link and customer receives the email
- [ ] Confirmation emails are sent
- [ ] Reminder emails are scheduled
- [ ] Admin can view/manage bookings
- [ ] Google Calendar sync works (if enabled)
