üöÄ DUST Hair Studio - Production Launch Checklist

Environment Variables Setup (Vercel)

Required Environment Variables in Vercel Dashboard:
Go to Vercel Dashboard ‚Üí Your Project ‚Üí Settings ‚Üí Environment Variables

Add these variables:

1. Supabase Variables:
   - NEXT_PUBLIC_SUPABASE_URL (your production Supabase URL)
   - NEXT_PUBLIC_SUPABASE_ANON_KEY (your production Supabase anon key)

2. Resend Email Variables:
   - RESEND_API_KEY (your production Resend API key)

3. Square Payment Variables (Optional - Fallback Only):
   - SQUARE_ACCESS_TOKEN (your PRODUCTION Square Access Token)
   - SQUARE_ENVIRONMENT (set to "production")
   - SQUARE_LOCATION_ID (your Square location ID)
   
   ‚ö†Ô∏è  IMPORTANT: Square credentials are now managed through the Admin Settings page!
   Environment variables are kept as fallback only. Configure Square in:
   Admin Panel ‚Üí Settings ‚Üí Payments Tab
   
   Square Payment Configuration:
   - Enable Square Payment Processing toggle
   - Set Environment: Sandbox (for soft launch) or Production (for live)
   - Add Square Application ID, Access Token, and Location ID
   - All settings are stored in database and can be changed without redeploying

4. Google Calendar Variables (if using):
   - GOOGLE_CLIENT_ID
   - GOOGLE_CLIENT_SECRET
   
   ‚ö†Ô∏è  IMPORTANT: Google OAuth App Must Be Published!
   
   If your Google Cloud app is in "Testing" mode, refresh tokens expire after 7 days,
   which will break the Google Calendar integration silently.
   
   To fix this:
   1. Go to Google Cloud Console: https://console.cloud.google.com
   2. Select your project
   3. Go to APIs & Services ‚Üí OAuth consent screen
   4. Under "Publishing status", click "PUBLISH APP"
   5. Confirm the change
   
   This will:
   - Keep the "Google hasn't verified this app" warning (admin clicks "Continue" to proceed)
   - But refresh tokens will NOT expire after 7 days
   - No verification process needed for internal use
   
   Note: The warning only appears during initial Google Calendar connection in admin settings,
   so it doesn't affect customer experience.

5. App URL Variable:
   - NEXT_PUBLIC_APP_URL
   
   ‚ö†Ô∏è  CRITICAL FOR PAYMENT LINKS!
   
   For Soft Launch (Current):
   - Value: https://website-sigma-steel-43.vercel.app
   
   For Production Launch:
   - ‚ö†Ô∏è  MUST UPDATE to: https://www.dusthairstudio.com
   - This is required for Square payment redirect URLs
   - After updating, MUST redeploy the project
   - Also update Square Developer Dashboard redirect URLs to match

Set Environment: Select "Production" for all variables
Redeploy: Trigger a new deployment after adding variables

Database Migration (Supabase)

Run this SQL in Supabase SQL Editor:

For Square payment tracking fields:
See: database-migrations/square-payment-fields.sql

Square Payment Settings Configuration

1. Access Admin Settings:
   - Go to your site: https://website-sigma-steel-43.vercel.app/admin
   - Navigate to Settings ‚Üí Payments Tab

2. Configure Square Settings:
   - ‚úÖ Enable "Square Payment Processing" toggle
   - üîß Set Environment: "Sandbox (Testing)" for soft launch
   - üìù Add Square Application ID (starts with sq0idp-...)
   - üîë Add Square Access Token (starts with EAAA...)
   - üìç Add Square Location ID
   - üíæ Click "Save Payment Settings"

3. For Soft Launch (Recommended):
   - Use Sandbox environment
   - Test with Square's test card numbers
   - Verify payment links are generated correctly

4. For Production Launch:
   - Switch Environment to "Production (Live)"
   - Update credentials with production values
   - Test with real (small) transactions first

Production Domain Switch (When Moving from Soft Launch to Full Launch)

When ready to launch on https://www.dusthairstudio.com:

1. Update Vercel Environment Variable:
   - Go to Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables
   - Find NEXT_PUBLIC_APP_URL
   - Change value from: https://website-sigma-steel-43.vercel.app
   - To: https://www.dusthairstudio.com
   - Save changes

2. Update Square Developer Dashboard:
   - Go to: https://developer.squareup.com/apps
   - Select your application
   - Go to OAuth settings
   - Update redirect URL from: https://website-sigma-steel-43.vercel.app/booking/confirmation
   - To: https://www.dusthairstudio.com/booking/confirmation
   - Save changes
   
   - Go to Point of Sale API settings
   - Update Web callback URL from: https://website-sigma-steel-43.vercel.app/api/webhooks/square
   - To: https://www.dusthairstudio.com/api/webhooks/square
   - Save changes

3. Configure Custom Domain in Vercel:
   - Go to Vercel Dashboard ‚Üí Settings ‚Üí Domains
   - Add domain: www.dusthairstudio.com
   - Add domain: dusthairstudio.com (redirect to www)
   - Follow Vercel's DNS configuration instructions
   - Wait for DNS propagation (can take up to 48 hours)

4. Redeploy Project:
   - Go to Deployments tab
   - Click "Redeploy" on latest deployment
   - Wait for deployment to complete

5. Test Everything on New Domain:
   - Visit https://www.dusthairstudio.com
   - Test customer booking flow
   - Test payment link generation
   - Verify emails have correct links
   - Test admin portal access

Email Templates Verification
Check if templates exist:
If missing, create them:
Code Deployment Status
‚úÖ Already Deployed:
Email service with cancellation/reschedule methods
API routes updated to trigger emails
Frontend UI updated for new template types
TypeScript build errors fixed
üîç Verify Deployment:
Check Vercel deployment logs for successful build
Confirm all commits are pushed to main branch
Test that admin panel shows "Cancellation" and "Reschedule" template types
Testing Checklist
Production Testing:
Create a test booking
Reschedule the booking ‚Üí Should send reschedule email
Cancel the booking ‚Üí Should send cancellation email
Check email delivery in Resend dashboard
Verify appointment links work correctly

Square Payment Testing (if enabled):
‚úÖ Test payment link generation in admin panel
‚úÖ Test Square POS integration:
   - Click "Pay Now (POS)" on a booking
   - Verify Square POS app opens with payment details
   - Test successful payment flow
   - Test payment cancellation flow
   - Verify callback page shows correct status
‚úÖ Verify Square credentials are working (check browser console for errors)
‚úÖ Test with Square's test card numbers:
   - Visa: 4111 1111 1111 1111
   - Mastercard: 5555 5555 5555 4444
   - Expiry: Any future date, CVV: Any 3 digits
‚úÖ Confirm payment webhooks are received
‚úÖ Verify booking status updates to "paid" after successful payment
MX Records (Separate Chat)
Email deliverability configuration
SPF/DKIM records for Resend
Domain authentication
üéØ Priority Order:

SOFT LAUNCH (Current - website-sigma-steel-43.vercel.app):
1. Environment Variables (Vercel) - Add NEXT_PUBLIC_APP_URL with soft launch URL
2. Database Migration (Supabase)
3. Square Payment Settings Configuration (Admin Panel)
4. Test Email Functionality
5. Test Square Payment Integration (if enabled)

PRODUCTION LAUNCH (dusthairstudio.com):
1. Configure Custom Domain in Vercel
2. Update NEXT_PUBLIC_APP_URL to https://www.dusthairstudio.com
3. Update Square redirect URLs in Developer Dashboard
4. Redeploy Project
5. Test Everything on Production Domain
6. MX Records & Domain Authentication (separate chat)

‚ö†Ô∏è IMPORTANT: Do not update NEXT_PUBLIC_APP_URL until custom domain is fully configured in Vercel and DNS has propagated!